<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Caixa Inteligente</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#121212;
    color:white;
    padding:20px;
}

h1,h2{
    color:#00ff88;
}

input{
    padding:8px;
    margin:5px 0;
    width:100%;
    border-radius:6px;
    border:none;
}

button{
    padding:8px 15px;
    margin-top:5px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    background:#00ff88;
    font-weight:bold;
}

button:hover{
    opacity:0.8;
}

.card{
    background:#1e1e1e;
    padding:15px;
    margin:10px 0;
    border-radius:10px;
}
</style>

</head>
<body>

<h1>üí∞ Caixa Inteligente</h1>

<h2>üì¶ Cadastrar Produto</h2>

<input type="text" id="nomeProduto" placeholder="Nome do Produto">
<input type="number" id="precoProduto" placeholder="Pre√ßo de Venda">
<input type="number" id="custoProduto" placeholder="Custo do Produto">

<button onclick="salvarProduto()">Salvar Produto</button>

<hr>

<h2>üìã Produtos Cadastrados</h2>
<div id="listaProdutos"></div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { 
    getFirestore, 
    collection, 
    addDoc, 
    getDocs, 
    doc, 
    updateDoc, 
    deleteDoc 
} from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_AUTH_DOMAIN",
  projectId: "SEU_PROJECT_ID",
  storageBucket: "SEU_STORAGE_BUCKET",
  messagingSenderId: "SEU_MESSAGING_ID",
  appId: "SEU_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

console.log("üî• Firebase conectado!");

// ==========================
// SALVAR PRODUTO
// ==========================

window.salvarProduto = async function(){

    const nome = document.getElementById("nomeProduto").value;
    const preco = parseFloat(document.getElementById("precoProduto").value);
    const custo = parseFloat(document.getElementById("custoProduto").value);

    if(!nome || !preco || !custo){
        alert("Preencha todos os campos");
        return;
    }

    await addDoc(collection(db,"produtos"),{
        nome,
        preco,
        custo
    });

    alert("Produto salvo!");

    document.getElementById("nomeProduto").value = "";
    document.getElementById("precoProduto").value = "";
    document.getElementById("custoProduto").value = "";

    carregarProdutos();
}

// ==========================
// CARREGAR PRODUTOS
// ==========================

async function carregarProdutos(){

    const lista = document.getElementById("listaProdutos");
    lista.innerHTML = "";

    const querySnapshot = await getDocs(collection(db,"produtos"));

    querySnapshot.forEach((documento)=>{

        const produto = documento.data();
        const id = documento.id;
        const lucro = produto.preco - produto.custo;

        lista.innerHTML += `
            <div class="card">
                <strong>${produto.nome}</strong><br>
                Pre√ßo: R$ ${produto.preco}<br>
                Custo: R$ ${produto.custo}<br>
                Lucro Unit√°rio: R$ ${lucro.toFixed(2)}<br><br>

                <button onclick="editarProduto('${id}','${produto.nome}',${produto.preco},${produto.custo})">
                ‚úè Editar
                </button>

                <button onclick="excluirProduto('${id}')">
                üóë Excluir
                </button>
            </div>
        `;
    });
}

// ==========================
// EDITAR PRODUTO
// ==========================

window.editarProduto = async function(id,nome,preco,custo){

    const novoNome = prompt("Novo nome:", nome);
    const novoPreco = prompt("Novo pre√ßo:", preco);
    const novoCusto = prompt("Novo custo:", custo);

    if(novoNome && novoPreco && novoCusto){

        await updateDoc(doc(db,"produtos",id),{
            nome:novoNome,
            preco:parseFloat(novoPreco),
            custo:parseFloat(novoCusto)
        });

        alert("Produto atualizado!");
        carregarProdutos();
    }
}

// ==========================
// EXCLUIR PRODUTO
// ==========================

window.excluirProduto = async function(id){

    if(confirm("Deseja excluir esse produto?")){
        await deleteDoc(doc(db,"produtos",id));
        alert("Produto exclu√≠do!");
        carregarProdutos();
    }
}

carregarProdutos();

</script>

</body>
</html>
